# Stream Device Protocol for an LIS CMS-ION radiation detector
# This protocol requires streamTty.o from Stream Device release_3_0
#
# Pete Owens 2-9-04
#
# Pete Owens 28-10-04
#      - Inserted Correct CRC values
#
# Pete Owens 22-2-05
#      - RESET=0|1
#      - Catch RS485 flow control (probably 0xff)
#

terminator   = 3;
buffersize   = 300;
replytimeout = 5000;
readtimeout  = 5000;
extrainput   = Ignore;

#
# Commands
#

recov { out 1 "001" CR 2 "RECOV=%{0\rEC4B|1\rEDDB}"; }
reset { out 1 "001" CR 2 "RESET=%{0\r7762|1\r76F2}"; }

#
# Incoming message (very long)
#

id         { in "%*{\?\?\1|\?\1|\1}%3d"; }
date       { in "%*{\?\?\1|\?\1|\1}\?\?\?,%10s"; }
tim        { in "%*{\?\?\1|\?\1|\1}\?\?\?,\?\?\?\?.\?\?.\?\?,%11s"; }
rate       { in "%*{\?\?\1|\?\1|\1}\?\?\?,\?\?\?\?.\?\?.\?\?,\?\?:\?\?:\?\?.\?\?" CR
              2 "01,%10f";
           }
dose       { in "%*{\?\?\1|\?\1|\1}\?\?\?,\?\?\?\?.\?\?.\?\?,\?\?:\?\?:\?\?.\?\?" CR
              2 "01,+\?.\?\?\?E\?\?\?,%10f";
           }
resettim   { in "%*{\?\?\1|\?\1|\1}\?\?\?,\?\?\?\?.\?\?.\?\?,\?\?:\?\?:\?\?.\?\?" CR
              2 "01,+\?.\?\?\?E\?\?\?,+\?.\?\?\?E\?\?\?,%11s";
           }
prshrdose  { in "%*{\?\?\1|\?\1|\1}\?\?\?,\?\?\?\?.\?\?.\?\?,\?\?:\?\?:\?\?.\?\?" CR
              2 "01,+\?.\?\?\?E\?\?\?,+\?.\?\?\?E\?\?\?,\?\?:\?\?:\?\?.\?\?,"
                "%10f";
           }
prsdaydose { in "%*{\?\?\1|\?\1|\1}\?\?\?,\?\?\?\?.\?\?.\?\?,\?\?:\?\?:\?\?.\?\?" CR
              2 "01,+\?.\?\?\?E\?\?\?,+\?.\?\?\?E\?\?\?,\?\?:\?\?:\?\?.\?\?,"
                "+\?.\?\?\?E\?\?\?,%10f";
           }
prsmondose { in "%*{\?\?\1|\?\1|\1}\?\?\?,\?\?\?\?.\?\?.\?\?,\?\?:\?\?:\?\?.\?\?" CR
              2 "01,+\?.\?\?\?E\?\?\?,+\?.\?\?\?E\?\?\?,\?\?:\?\?:\?\?.\?\?,"
                "+\?.\?\?\?E\?\?\?,+\?.\?\?\?E\?\?\?,%10f";
           }
prvhrdose  { in "%*{\?\?\1|\?\1|\1}\?\?\?,\?\?\?\?.\?\?.\?\?,\?\?:\?\?:\?\?.\?\?" CR
              2 "01,+\?.\?\?\?E\?\?\?,+\?.\?\?\?E\?\?\?,\?\?:\?\?:\?\?.\?\?,"
                "+\?.\?\?\?E\?\?\?,+\?.\?\?\?E\?\?\?,+\?.\?\?\?E\?\?\?,"
                "%10f";
           }
prvdaydose { in "%*{\?\?\1|\?\1|\1}\?\?\?,\?\?\?\?.\?\?.\?\?,\?\?:\?\?:\?\?.\?\?" CR
              2 "01,+\?.\?\?\?E\?\?\?,+\?.\?\?\?E\?\?\?,\?\?:\?\?:\?\?.\?\?,"
                "+\?.\?\?\?E\?\?\?,+\?.\?\?\?E\?\?\?,+\?.\?\?\?E\?\?\?,"
                "+\?.\?\?\?E\?\?\?,%10f";
           }
prvmondose { in "%*{\?\?\1|\?\1|\1}\?\?\?,\?\?\?\?.\?\?.\?\?,\?\?:\?\?:\?\?.\?\?" CR
              2 "01,+\?.\?\?\?E\?\?\?,+\?.\?\?\?E\?\?\?,\?\?:\?\?:\?\?.\?\?,"
                "+\?.\?\?\?E\?\?\?,+\?.\?\?\?E\?\?\?,+\?.\?\?\?E\?\?\?,"
                "+\?.\?\?\?E\?\?\?,+\?.\?\?\?E\?\?\?,%10f";
           }
almsta     { in "%*{\?\?\1|\?\1|\1}\?\?\?,\?\?\?\?.\?\?.\?\?,\?\?:\?\?:\?\?.\?\?" CR
              2 "01,+\?.\?\?\?E\?\?\?,+\?.\?\?\?E\?\?\?,\?\?:\?\?:\?\?.\?\?,"
                "+\?.\?\?\?E\?\?\?,+\?.\?\?\?E\?\?\?,+\?.\?\?\?E\?\?\?,"
                "+\?.\?\?\?E\?\?\?,+\?.\?\?\?E\?\?\?,+\?.\?\?\?E\?\?\?,"
                "%2x";
           }
eqpsta     { in "%*{\?\?\1|\?\1|\1}\?\?\?,\?\?\?\?.\?\?.\?\?,\?\?:\?\?:\?\?.\?\?" CR
              2 "01,+\?.\?\?\?E\?\?\?,+\?.\?\?\?E\?\?\?,\?\?:\?\?:\?\?.\?\?,"
                "+\?.\?\?\?E\?\?\?,+\?.\?\?\?E\?\?\?,+\?.\?\?\?E\?\?\?,"
                "+\?.\?\?\?E\?\?\?,+\?.\?\?\?E\?\?\?,+\?.\?\?\?E\?\?\?,"
                "\?\?,%2x";
           }
mode       { in "%*{\?\?\1|\?\1|\1}\?\?\?,\?\?\?\?.\?\?.\?\?,\?\?:\?\?:\?\?.\?\?" CR
              2 "01,+\?.\?\?\?E\?\?\?,+\?.\?\?\?E\?\?\?,\?\?:\?\?:\?\?.\?\?,"
                "+\?.\?\?\?E\?\?\?,+\?.\?\?\?E\?\?\?,+\?.\?\?\?E\?\?\?,"
                "+\?.\?\?\?E\?\?\?,+\?.\?\?\?E\?\?\?,+\?.\?\?\?E\?\?\?,"
                "\?\?,\?\?,%x";
           }



#################################################################################
